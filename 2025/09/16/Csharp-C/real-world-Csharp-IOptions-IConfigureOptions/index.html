<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/myfavicon180.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/myfavicon32.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/myfavicon16.ico">
  <link rel="mask-icon" href="/images/myfavicon512.png" color="#222">
  <meta name="google-site-verification" content="w7KbKnFK6ZmNdwvzSukWPppTy0_LnuUA85bPeSxhkOI">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300italic,400,400italic,700,700italic%7CNoto+Sans+TC:300,300italic,400,400italic,700,700italic%7CSegoe+UI:300,300italic,400,400italic,700,700italic%7CHelvetica+Neue:300,300italic,400,400italic,700,700italic%7CRoboto:300,300italic,400,400italic,700,700italic%7CLato:300,300italic,400,400italic,700,700italic%7Csans-serif:300,300italic,400,400italic,700,700italic%7Cconsolas:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"jenifers001d.github.io","root":"/","images":"/images","scheme":"Mist","darkmode":false,"version":"8.21.1","exturl":true,"sidebar":{"position":"right","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":"mac"},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"disqus","storage":true,"lazyload":false,"nav":null,"activeClass":"disqus"},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜尋...","empty":"我們無法找到任何有關 ${query} 的搜索結果","hits_time":"找到 ${hits} 個搜索結果（用時 ${time} 毫秒）","hits":"找到 ${hits} 個搜索結果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="在 .NET Core 5+ 的開發中，處理應用程式的組態 (Configuration) 是一個很重要的議題。這套全新的組態系統，目的在解決傳統 .NET Framework 時代組態管理的痛點，讓程式碼更具彈性、更好維護，也更符合現代軟體開發的設計模式。">
<meta property="og:type" content="article">
<meta property="og:title" content="工作中的 C# 實作：.NET 組態系統 - IOptions 與 IConfigureOptions">
<meta property="og:url" content="https://jenifers001d.github.io/2025/09/16/Csharp-C/real-world-Csharp-IOptions-IConfigureOptions/">
<meta property="og:site_name" content="Jenifer.Code.World">
<meta property="og:description" content="在 .NET Core 5+ 的開發中，處理應用程式的組態 (Configuration) 是一個很重要的議題。這套全新的組態系統，目的在解決傳統 .NET Framework 時代組態管理的痛點，讓程式碼更具彈性、更好維護，也更符合現代軟體開發的設計模式。">
<meta property="og:locale" content="zh_TW">
<meta property="article:published_time" content="2025-09-15T14:43:50.000Z">
<meta property="article:modified_time" content="2025-09-20T06:28:53.565Z">
<meta property="article:author" content="Jenifer">
<meta property="article:tag" content="Advanced Code">
<meta property="article:tag" content="Csharp(C#)">
<meta property="article:tag" content=".Net Core">
<meta property="article:tag" content="Real-world coding">
<meta property="article:tag" content="Advanced Csharp(C#)">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://jenifers001d.github.io/2025/09/16/Csharp-C/real-world-Csharp-IOptions-IConfigureOptions/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-TW","comments":true,"permalink":"https://jenifers001d.github.io/2025/09/16/Csharp-C/real-world-Csharp-IOptions-IConfigureOptions/","path":"2025/09/16/Csharp-C/real-world-Csharp-IOptions-IConfigureOptions/","title":"工作中的 C# 實作：.NET 組態系統 - IOptions 與 IConfigureOptions"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>工作中的 C# 實作：.NET 組態系統 - IOptions 與 IConfigureOptions | Jenifer.Code.World</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切換導航欄" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Jenifer.Code.World</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Jenifer 的技術筆記</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜尋" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首頁</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>標籤</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分類</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>歸檔</a></li><li class="menu-item menu-item-privacy"><a href="/privacy/" rel="section"><i class="fa fa-lock fa-fw"></i>privacy</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目錄
        </li>
        <li class="sidebar-nav-overview">
          本站概要
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%80%E9%BA%BC%E6%98%AF%E7%B5%84%E6%85%8B%EF%BC%9F%E7%82%BA%E4%BB%80%E9%BA%BC%E9%9C%80%E8%A6%81%E5%AE%83%EF%BC%9F"><span class="nav-number">2.</span> <span class="nav-text">什麼是組態？為什麼需要它？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#NET-Core-5-%E7%B5%84%E6%85%8B%E7%B3%BB%E7%B5%B1%E7%9A%84%E9%81%8B%E4%BD%9C%E6%96%B9%E5%BC%8F"><span class="nav-number">3.</span> <span class="nav-text">.NET Core 5+ 組態系統的運作方式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%A9%9F-1%EF%BC%9A%E8%AE%80%E5%8F%96%E7%B5%84%E6%85%8B%E4%BE%86%E6%BA%90"><span class="nav-number">3.1.</span> <span class="nav-text">步驟 1：讀取組態來源</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%A9%9F-2%EF%BC%9A%E8%BC%89%E5%85%A5%E5%88%B0-IConfiguration-%E7%89%A9%E4%BB%B6"><span class="nav-number">3.2.</span> <span class="nav-text">步驟 2：載入到 IConfiguration 物件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%A9%9F-3%EF%BC%9A%E4%BD%BF%E7%94%A8-IConfiguration-%E5%AD%98%E5%8F%96%E7%B5%84%E6%85%8B"><span class="nav-number">3.3.</span> <span class="nav-text">步驟 3：使用 IConfiguration 存取組態</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#GetValue-T-%EF%BC%9A%E5%8F%96%E5%BE%97%E5%96%AE%E4%B8%80%E5%80%BC"><span class="nav-number">3.3.1.</span> <span class="nav-text">GetValue&lt;T&gt;：取得單一值</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#GetSection%EF%BC%9A%E5%8F%96%E5%BE%97%E4%B8%80%E5%80%8B%E5%AD%90%E5%8D%80%E5%A1%8A"><span class="nav-number">3.3.2.</span> <span class="nav-text">GetSection：取得一個子區塊</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IOptions%EF%BC%9A%E5%B0%87%E7%B5%84%E6%85%8B%E7%B6%81%E5%AE%9A%E5%88%B0-C-Options-%E7%89%A9%E4%BB%B6"><span class="nav-number">4.</span> <span class="nav-text">IOptions：將組態綁定到 C# Options 物件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-IOptions-T-%E5%96%AE%E4%BE%8B-Singleton"><span class="nav-number">4.1.</span> <span class="nav-text">1. IOptions&lt;T&gt; (單例 Singleton)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-IOptionsSnapshot-T-%E7%AF%84%E5%9C%8D-Scoped"><span class="nav-number">4.2.</span> <span class="nav-text">2. IOptionsSnapshot&lt;T&gt; (範圍 Scoped)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-IOptionsMonitor-T-%E5%8F%AF%E7%9B%A3%E6%8E%A7%E5%96%AE%E4%BE%8B-Singleton"><span class="nav-number">4.3.</span> <span class="nav-text">3. IOptionsMonitor&lt;T&gt; (可監控單例 Singleton)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AF%84%E4%BE%8B%EF%BC%9A%E7%94%A8-builder-Services-Configure-T-%E5%B0%87%E7%B5%84%E6%85%8B%E7%B6%81%E5%AE%9A%E5%88%B0%E9%A1%9E%E5%88%A5%EF%BC%8C%E5%86%8D%E7%94%A8-IOptions-T-%E5%9C%A8%E5%85%B6%E4%BB%96-Service-%E5%8F%96%E5%BE%97"><span class="nav-number">4.4.</span> <span class="nav-text">範例：用 builder.Services.Configure&lt;T&gt;() 將組態綁定到類別，再用 IOptions&lt;T&gt; 在其他 Service 取得</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%AD%A5%E9%A9%9F-1%EF%BC%9A%E5%AE%9A%E7%BE%A9-Options-%E9%A1%9E%E5%88%A5"><span class="nav-number">4.4.1.</span> <span class="nav-text">步驟 1：定義 Options 類別</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%AD%A5%E9%A9%9F-2%EF%BC%9A%E5%9C%A8-Program-cs-%E8%A8%BB%E5%86%8A%E6%9C%8D%E5%8B%99"><span class="nav-number">4.4.2.</span> <span class="nav-text">步驟 2：在 Program.cs 註冊服務</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E4%BD%BF%E7%94%A8-IOptions-%E6%B3%A8%E5%85%A5%E4%B8%A6%E5%AD%98%E5%8F%96"><span class="nav-number">4.4.3.</span> <span class="nav-text">3. 使用 IOptions 注入並存取</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IConfigureOptions%EF%BC%9A%E5%B0%87%E7%B5%84%E6%85%8B%E9%82%8F%E8%BC%AF%E7%8D%A8%E7%AB%8B%E6%88%90%E9%A1%9E%E5%88%A5"><span class="nav-number">5.</span> <span class="nav-text">IConfigureOptions：將組態邏輯獨立成類別</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#IConfigureOptions-T-vs-Configure-T"><span class="nav-number">5.1.</span> <span class="nav-text">IConfigureOptions&lt;T&gt; vs. Configure&lt;T&gt;()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AF%84%E4%BE%8B%EF%BC%9A%E4%BD%BF%E7%94%A8-IConfigureOptions"><span class="nav-number">5.2.</span> <span class="nav-text">範例：使用 IConfigureOptions</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%AD%A5%E9%A9%9F-1%EF%BC%9A%E5%BB%BA%E7%AB%8B-IConfigureOptions-%E5%AF%A6%E4%BD%9C%E9%A1%9E%E5%88%A5"><span class="nav-number">5.2.1.</span> <span class="nav-text">步驟 1：建立 IConfigureOptions 實作類別</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%AD%A5%E9%A9%9F-2%EF%BC%9A%E5%9C%A8-Program-cs-%E8%A8%BB%E5%86%8A%E6%9C%8D%E5%8B%99-v2"><span class="nav-number">5.2.2.</span> <span class="nav-text">步驟 2：在 Program.cs 註冊服務</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%B8%BD%E7%B5%90"><span class="nav-number">6.</span> <span class="nav-text">總結</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Jenifer</p>
  <div class="site-description" itemprop="description">My notes about web development, front-end, back-end and any kind techniques related to IT.</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">92</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">分類</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">57</span>
        <span class="site-state-item-name">標籤</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          連結
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <span class="exturl" data-url="aHR0cHM6Ly9ob3BvdXQuY29tLnR3Lw==" title="https:&#x2F;&#x2F;hopout.com.tw&#x2F;">Explore Taiwan</span>
            </li>
        </ul>
      </div>
    </div><!--google_adsense-->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6866375976707228" crossorigin="anonymous"></script>
      <div class="sidebar-google-adsense">
        <div class="adsense-title">
          <i class="fab fa-google"></i> AdSense
        </div>
        <div class="google-adsense-instance">
            <ins class="adsbygoogle"
                style="display:block"
                data-ad-client="ca-pub-6866375976707228"
                data-ad-slot="1016873827"
                data-ad-format="auto"
                data-full-width-responsive="true"></ins>
            <script>
                 (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>        
      </div>
<!--/google_adsense-->
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://jenifers001d.github.io/2025/09/16/Csharp-C/real-world-Csharp-IOptions-IConfigureOptions/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jenifer">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jenifer.Code.World">
      <meta itemprop="description" content="My notes about web development, front-end, back-end and any kind techniques related to IT.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="工作中的 C# 實作：.NET 組態系統 - IOptions 與 IConfigureOptions | Jenifer.Code.World">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          工作中的 C# 實作：.NET 組態系統 - IOptions 與 IConfigureOptions
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2025-09-16 00:43:50" itemprop="dateCreated datePublished" datetime="2025-09-16T00:43:50+10:00">2025-09-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新於</span>
      <time title="修改時間：2025-09-20 16:28:53" itemprop="dateModified" datetime="2025-09-20T16:28:53+10:00">2025-09-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Csharp-C/" itemprop="url" rel="index"><span itemprop="name">Csharp(C#)</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><!--google_adsense-->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6866375976707228" crossorigin="anonymous"></script>
      <div class="postheader-google-adsense">
        <i class="fab fa-google"></i> AdSense
        <div class="google-adsense-instance">
            <ins class="adsbygoogle"
                style="display:block"
                data-ad-client="ca-pub-6866375976707228"
                data-ad-slot="1016873827"
                data-ad-format="auto"
                data-full-width-responsive="true"></ins>
            <script>
                 (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>        
      </div>
<!--/google_adsense--><h2 id="前言"><a class="header-anchor" href="#前言"></a>前言</h2>

<p>在 .NET Core 5+ 的開發中，處理應用程式的組態 (Configuration) 是一個很重要的議題。這套全新的組態系統，目的在解決傳統 .NET Framework 時代組態管理的痛點，讓程式碼更具彈性、更好維護，也更符合現代軟體開發的設計模式。</p>

<h2 id="什麼是組態？為什麼需要它？"><a class="header-anchor" href="#什麼是組態？為什麼需要它？"></a>什麼是組態？為什麼需要它？</h2>
<p>組態就像是你的應用程式的「設定檔」。它包含了所有在程式碼之外、但會影響程式行為的資訊。</p>
<p>例如：</p>
<ul>
<li><strong>資料庫連線字串</strong>：程式需要知道要連線到哪一個資料庫。</li>
<li><strong>第三方服務的 API 金鑰</strong>：例如，寄送 Email 服務的 API 金鑰。</li>
<li><strong>功能開關 (Feature Flags)</strong>：用來動態開啟或關閉某些功能。</li>
</ul>
<p>將這些設定與程式碼分離，有以下幾個好處：</p>
<ul>
<li><strong>環境區隔</strong>：你可以在不同的環境 (開發、測試、正式) 使用不同的設定，而不需要修改程式碼。</li>
<li><strong>易於維護</strong>：當設定改變時，你只需要修改設定檔，而不需要重新編譯整個應用程式。</li>
<li><strong>符合單一職責原則</strong>：程式碼只負責執行邏輯，而組態則負責提供外部設定。</li>
</ul>
<h2 id="NET-Core-5-組態系統的運作方式"><a class="header-anchor" href="#NET-Core-5-組態系統的運作方式"></a>.NET Core 5+ 組態系統的運作方式</h2>
<p>在 .NET Core 5+ 中，組態的運作是一個「<strong>讀取-載入-存取</strong>」的流程。</p>
<h3 id="步驟-1：讀取組態來源"><a class="header-anchor" href="#步驟-1：讀取組態來源"></a>步驟 1：讀取組態來源</h3>
<p>框架在應用程式啟動時，會自動讀取多個組態來源。這些來源的資料會被合併，且<span style="color: #ff0000">後讀取的會覆蓋先前的</span>。</p>
<p>預設的組態來源順序為：</p>
<ol>
<li><code>appsettings.json</code></li>
<li><code>appsettings.[環境名稱].json</code> (例如：<code>appsettings.Development.json</code>)</li>
<li>使用者機密 (User Secrets，僅在開發環境)</li>
<li>環境變數 (Environment Variables)</li>
<li>命令列引數 (Command-line Arguments)</li>
</ol>
<p><strong>範例</strong></p>
<p>假設我們有以下 <code>appsettings.json</code> 檔案：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;Logging&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;LogLevel&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;Default&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Information&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;MyStringKey&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Hello World&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;MyNumberKey&quot;</span><span class="punctuation">:</span> <span class="number">123</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>如果 <code>appsettings.json</code> 和 <code>appsettings.Development.json</code> 都有一個名為 <code>MyStringKey</code> 的設定，則最終生效的會是 <code>appsettings.Development.json</code> 裡面的值，因為它在後面被讀取。</p>
<h3 id="步驟-2：載入到-IConfiguration-物件"><a class="header-anchor" href="#步驟-2：載入到-IConfiguration-物件"></a>步驟 2：載入到 <code>IConfiguration</code> 物件</h3>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">builder.Configuration.AddJsonFile(<span class="string">&quot;appsettings.json&quot;</span>)</span><br><span class="line">    .AddJsonFile(<span class="string">&quot;appsettings.Development.json&quot;</span>)</span><br><span class="line">    .AddEnvironmentVariables();</span><br></pre></td></tr></table></figure>
<p>上方程式碼會將所有讀取到的組態資料，以<strong>鍵值對 (key-value pair)</strong> 的形式載入到記憶體中，並將它封裝成一個<strong>抽象化的 <code>IConfiguration</code> 物件</strong>。</p>
<p>這個 <code>IConfiguration</code> 物件就像是一個巨大的字典，你的程式碼只需要從這個字典中查詢資料，而不需要知道這些資料是從哪個檔案或來源來的。</p>
<p>在記憶體中，上述的 <code>appsettings.json</code> 檔案會被轉換為類似以下形式的鍵值對：</p>
<ul>
<li><code>Logging:LogLevel:Default</code> -&gt; <code>&quot;Information&quot;</code></li>
<li><code>MyStringKey</code> -&gt; <code>&quot;Hello World&quot;</code></li>
<li><code>MyNumberKey</code> -&gt; <code>&quot;123&quot;</code></li>
</ul>
<h3 id="步驟-3：使用-IConfiguration-存取組態"><a class="header-anchor" href="#步驟-3：使用-IConfiguration-存取組態"></a>步驟 3：使用 <code>IConfiguration</code> 存取組態</h3>
<p>從 <code>IConfiguration</code> 讀取資料的方式主要有兩種：<code>GetValue</code> 和 <code>GetSection</code>。</p>
<h4 id="GetValue-T-：取得單一值"><a class="header-anchor" href="#GetValue-T-：取得單一值"></a>GetValue<code>&lt;T&gt;</code>：取得單一值</h4>
<p><code>GetValue&lt;T&gt;()</code> 用來取得一個單一、簡單的組態值，並且可以將該值自動轉換成你指定的類型。</p>
<ul>
<li><strong>用法：</strong> <code>builder.Configuration.GetValue&lt;string&gt;(&quot;鍵名&quot;)</code></li>
<li><strong>範例：</strong>
<ul>
<li><code>string logLevel = builder.Configuration.GetValue&lt;string&gt;(&quot;Logging:LogLevel:Default&quot;);</code></li>
<li><code>int myNumber = builder.Configuration.GetValue&lt;int&gt;(&quot;MyNumberKey&quot;);</code></li>
</ul>
</li>
<li><strong>特色：</strong> 可以用冒號 <code>:</code> 來代表層級，直接取得巢狀結構中的值。</li>
</ul>
<h4 id="GetSection：取得一個子區塊"><a class="header-anchor" href="#GetSection：取得一個子區塊"></a>GetSection：取得一個子區塊</h4>
<p><code>GetSection()</code> 用來取得一個組態的<strong>子區塊</strong>。它回傳一個 <code>IConfigurationSection</code> 物件，這個物件本身也實作了 <code>IConfiguration</code> 介面，讓你可以繼續在它上面呼叫方法。</p>
<ul>
<li><strong>用法：</strong> <code>builder.Configuration.GetSection(&quot;區塊名稱&quot;)</code></li>
<li><strong>範例：</strong>
<ul>
<li><code>var loggingSection = builder.Configuration.GetSection(&quot;Logging&quot;);</code></li>
<li>可以用冒號 <code>:</code> 和 <code>GetValue&lt;T&gt;()</code>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var logLevel = builder.Configuration</span><br><span class="line">    .GetSection(&quot;Logging:LogLevel&quot;)</span><br><span class="line">    .GetValue&lt;string&gt;(&quot;Default&quot;);</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><strong>特色：</strong>
<ul>
<li>回傳一個物件，這個物件可以繼續被查詢。</li>
<li><code>GetSection</code> 不會回傳 <code>null</code>，即使找不到對應的區塊，它也會回傳一個空物件，避免了空指標例外 (Null Reference Exception)。</li>
<li>這是<span style="color: #ff0000"><strong>將組態綁定到 C# 類別</strong></span>的起手式。</li>
<li><code>IConfigurationSection</code> 提供 <strong><code>Bind()</code></strong> 將組態的<strong>區塊</strong>綁訂到 C# 類別。因此，實務上，<span style="color: #ff0000"><code>GetSection</code> 通常搭配 <code>Bind()</code> 方法使用</span>。</li>
</ul>
</li>
</ul>
<hr>
<h2 id="IOptions：將組態綁定到-C-Options-物件"><a class="header-anchor" href="#IOptions：將組態綁定到-C-Options-物件"></a>IOptions：將組態綁定到 C# Options 物件</h2>
<p>雖然直接從 <code>IConfiguration</code> 讀取資料很方便，但如果組態很多，一個個 <code>GetValue</code> 會讓程式碼很凌亂。這時，我們就需要<span style="color: #ff0000">將組態綁定到一個<strong>簡單的 C# 類別</strong></span>，這個類別就稱為 <code>Options</code> 物件，例如：下方的 <code>EmailSettingOptions</code>。它的<strong>職責</strong>是「<span style="color: #ff0000">提供</span>」這個 C# 類別的物件，例如：提供 <code>EmailSettingOptions</code> 物件。</p>
<p><code>IOptions</code> 家族就是用來管理這些 Option 物件的介面。</p>
<h3 id="1-IOptions-T-單例-Singleton"><a class="header-anchor" href="#1-IOptions-T-單例-Singleton"></a>1. IOptions<code>&lt;T&gt;</code> (單例 Singleton)</h3>
<p>此介面將 Option 物件註冊為<strong>單例 (Singleton)</strong> 服務。</p>
<ul>
<li><strong>功能：</strong> 組態值在應用程式啟動時只會被讀取並初始化<strong>一次</strong>，然後注入到你的類別中。</li>
<li><strong>特性：</strong> 應用程式啟動後，一旦設定完成，它的值在<span style="color: #ff0000">整個應用程式的生命週期中都<strong>不會改變</strong></span>。</li>
<li><strong>適用場景：</strong> 幾乎所有情況都適用，特別是那些在程式運行期間不會改變的設定。例如資料庫連線字串、API Key 等。</li>
</ul>
<h3 id="2-IOptionsSnapshot-T-範圍-Scoped"><a class="header-anchor" href="#2-IOptionsSnapshot-T-範圍-Scoped"></a>2. IOptionsSnapshot<code>&lt;T&gt;</code> (範圍 Scoped)</h3>
<p>此介面將 Option 物件註冊為<strong>範圍 (Scoped)</strong> 服務。</p>
<ul>
<li><strong>功能：</strong> 讓你在<strong>每個 HTTP 請求</strong>中重新讀取一次組態。</li>
<li><strong>特性：</strong> 每次 HTTP 請求都會建立一個新的實體，<span style="color: #ff0000">同一個請求內，組態值會保持不變</span>。這能確保單次操作中的資料一致性。。</li>
<li><strong>適用場景：</strong> 很少使用，主要用於當你希望在一個請求中，所有讀取的組態值都保持一致，即使組態檔案在請求期間有變動。例如，基於請求標頭 (Header) 或 URL 參數動態載入的設定。</li>
</ul>
<h3 id="3-IOptionsMonitor-T-可監控單例-Singleton"><a class="header-anchor" href="#3-IOptionsMonitor-T-可監控單例-Singleton"></a>3. IOptionsMonitor<code>&lt;T&gt;</code> (可監控單例 Singleton)</h3>
<p>此介面將 Option 物件註冊為<strong>單例 (Singleton)</strong> 服務，但它提供<strong>監控</strong>組態變動的功能。</p>
<ul>
<li><strong>功能：</strong> 讓你的程式碼可以<span style="color: #ff0000"><strong>監控組態的變動</strong>，並在變動時自動更新</span>。</li>
<li><strong>特性：</strong> 提供一個 <code>OnChange</code> 事件，你可以訂閱這個事件來接收組態變更的通知，並執行額外的邏輯。</li>
<li><strong>適用場景：</strong> 需要「熱重載」(Hot Reload) 的組態，例如動態變更記錄等級 (Log Level) 或服務的開關 (Feature Flags)，而不需要重啟應用程式。</li>
</ul>
<h3 id="範例：用-builder-Services-Configure-T-將組態綁定到類別，再用-IOptions-T-在其他-Service-取得"><a class="header-anchor" href="#範例：用-builder-Services-Configure-T-將組態綁定到類別，再用-IOptions-T-在其他-Service-取得"></a>範例：用 <code>builder.Services.Configure&lt;T&gt;()</code> 將組態綁定到類別，再用 <code>IOptions&lt;T&gt;</code> 在其他 Service 取得</h3>
<p>這是一個最常見的用法，它將 <code>appsettings.json</code> 的 <code>EmailSettings</code> 區塊綁定到 <code>EmailSettingOptions</code> 類別。</p>
<h4 id="步驟-1：定義-Options-類別"><a class="header-anchor" href="#步驟-1：定義-Options-類別"></a>步驟 1：定義 Options 類別</h4>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">EmailSettingOptions</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> SmtpServer &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Port &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> SenderName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步驟-2：在-Program-cs-註冊服務"><a class="header-anchor" href="#步驟-2：在-Program-cs-註冊服務"></a>步驟 2：在 <code>Program.cs</code> 註冊服務</h4>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Program.cs</span></span><br><span class="line">builder.Services.Configure&lt;EmailSettingOptions&gt;(builder.Configuration.GetSection(<span class="string">&quot;EmailSettings&quot;</span>));</span><br></pre></td></tr></table></figure>
<p>這行程式碼會將 <code>EmailSettingOptions</code> 類別註冊到 DI 容器，並告訴它：「請用 <code>IConfiguration</code> 中 <code>EmailSettings</code> 這個區塊的資料來設定這個類別」，也就是將組態綁定到類別。</p>
<p>如果不要用組態來設定，可以用如下：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">builder.Services.Configure&lt;EmailSettingOptions&gt;(options =&gt;</span><br><span class="line">&#123;</span><br><span class="line">    options.SmtpServer = <span class="string">&quot;localhost&quot;</span>; <span class="comment">// 直接設定一個固定值</span></span><br><span class="line">    options.Port = <span class="number">25</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="3-使用-IOptions-注入並存取"><a class="header-anchor" href="#3-使用-IOptions-注入並存取"></a>3. 使用 <code>IOptions</code> 注入並存取</h4>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyEmailService</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> EmailSettingOptions _emailSettings;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 透過 IOptions&lt;T&gt; 注入</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyEmailService</span>(<span class="params">IOptions&lt;EmailSettingOptions&gt; options</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _emailSettings = options.Value; <span class="comment">// 透過 .Value 屬性取得 Option 物件</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="IConfigureOptions：將組態邏輯獨立成類別"><a class="header-anchor" href="#IConfigureOptions：將組態邏輯獨立成類別"></a>IConfigureOptions：將組態邏輯獨立成類別</h2>
<p><code>IConfigureOptions&lt;T&gt;</code> 是另一個用來設定 Options 的介面，它的<strong>職責</strong>是「<span style="color: #ff0000">直接配置</span>」這個 T 物件本身。它的主要用途是將<strong>複雜的設定邏輯</strong>與你的啟動程式碼 (例如 <code>Program.cs</code>) 分離。</p>
<h3 id="IConfigureOptions-T-vs-Configure-T"><a class="header-anchor" href="#IConfigureOptions-T-vs-Configure-T"></a><code>IConfigureOptions&lt;T&gt;</code> vs. <code>Configure&lt;T&gt;()</code></h3>
<table>
<thead>
<tr>
<th style="text-align:left"></th>
<th style="text-align:left"><code>Configure&lt;T&gt;()</code> (Lambda 函式)</th>
<th style="text-align:left"><code>IConfigureOptions&lt;T&gt;</code> (介面實作)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>用法</strong></td>
<td style="text-align:left">簡潔，直接用 <span style="color: #ff0000">Lambda 函式</span>設定</td>
<td style="text-align:left">將設定邏輯封裝在一個<span style="color: #ff0000">獨立的類別</span>中</td>
</tr>
<tr>
<td style="text-align:left"><strong>主要優點</strong></td>
<td style="text-align:left">方便、程式碼精簡</td>
<td style="text-align:left">可重複使用、支援依賴注入</td>
</tr>
<tr>
<td style="text-align:left"><strong>適用場景</strong></td>
<td style="text-align:left">簡單的設定，直接從檔案綁定</td>
<td style="text-align:left">複雜的設定，需要依賴其他服務或進行額外的邏輯處理</td>
</tr>
<tr>
<td style="text-align:left"><strong>範例</strong></td>
<td style="text-align:left"><code>services.Configure&lt;EmailSettingOptions&gt;(options =&gt; &#123; ... &#125;);</code></td>
<td style="text-align:left"><code>services.ConfigureOptions&lt;ConfigureEmailSettings&gt;();</code></td>
</tr>
</tbody>
</table>
<h3 id="範例：使用-IConfigureOptions"><a class="header-anchor" href="#範例：使用-IConfigureOptions"></a>範例：使用 <code>IConfigureOptions</code></h3>
<p>假設你的設定需要從 <code>IConfiguration</code> 讀取，並進行額外處理。</p>
<h4 id="步驟-1：建立-IConfigureOptions-實作類別"><a class="header-anchor" href="#步驟-1：建立-IConfigureOptions-實作類別"></a>步驟 1：建立 <code>IConfigureOptions</code> 實作類別</h4>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> Microsoft.Extensions.Configuration;</span><br><span class="line"><span class="keyword">using</span> Microsoft.Extensions.Options;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ConfigureEmailSettings</span> : <span class="title">IConfigureOptions</span>&lt;<span class="title">EmailSettingOptions</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">readonly</span> IConfiguration _configuration;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ConfigureEmailSettings</span>(<span class="params">IConfiguration configuration</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _configuration = configuration;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Configure</span>(<span class="params">EmailSettingOptions options</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        _configuration.GetSection(<span class="string">&quot;EmailSettings&quot;</span>).Bind(options); <span class="comment">// GetSection 搭配 Bind，將組態綁定到類別</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 額外邏輯：如果沒有設定寄件人名稱，則給一個預設值</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">string</span>.IsNullOrEmpty(options.SmtpServer))</span><br><span class="line">        &#123;</span><br><span class="line">            options.SmtpServer = <span class="string">&quot;default.smtp.server&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="步驟-2：在-Program-cs-註冊服務-v2"><a class="header-anchor" href="#步驟-2：在-Program-cs-註冊服務-v2"></a>步驟 2：在 <code>Program.cs</code> 註冊服務</h4>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Program.cs</span></span><br><span class="line"><span class="comment">// 這是最簡單的註冊方式，它會自動處理底層的註冊細節</span></span><br><span class="line">builder.Services.ConfigureOptions&lt;ConfigureEmailSettings&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 或者，你也可以用底層的註冊方式：</span></span><br><span class="line"><span class="comment">// builder.Services.AddSingleton&lt;IConfigureOptions&lt;EmailSettingOptions&gt;, ConfigureEmailSettings&gt;();</span></span><br><span class="line"><span class="comment">// builder.Services.AddOptions&lt;EmailSettingOptions&gt;();</span></span><br></pre></td></tr></table></figure>
<p><code>ConfigureOptions&lt;T&gt;</code> (或者 <code>Configure&lt;T&gt;</code>) 是 .NET Core 5+ 提供的一個<strong>語法糖 (Syntactic Sugar)</strong>。</p>
<p><code>builder.Services.ConfigureOptions&lt;ConfigureEmailSettings&gt;();</code> 在底層其實就等同於如下程式碼，避免開發者忘記註冊 <code>AddOptions&lt;T&gt;()</code>：</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 告訴 DI 容器：「當有人需要 IConfigureOptions&lt;EmailSettingOptions&gt; 這個服務時，</span></span><br><span class="line"><span class="comment">// 請建立一個 ConfigureEmailSettings 的單例 (Singleton) 實體給他</span></span><br><span class="line">builder.Services.AddSingleton&lt;IConfigureOptions&lt;EmailSettingOptions&gt;, ConfigureEmailSettings&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">// ConfigureEmailSettings 裡會用到 EmailSettingOptions。</span></span><br><span class="line"><span class="comment">// 沒註冊的話，DI 容器可能不知道如何從它來建立 IOptions&lt;T&gt; 物件</span></span><br><span class="line"><span class="comment">// AddOptions&lt;T&gt; 是專門為 Option 系統設計的輔助方法，它會幫你完成一些預設的設定，例如註冊 IOptions&lt;EmailSettingOptions&gt;</span></span><br><span class="line">builder.Services.AddOptions&lt;EmailSettingOptions&gt;();</span><br></pre></td></tr></table></figure>
<h2 id="總結"><a class="header-anchor" href="#總結"></a>總結</h2>
<ul>
<li><strong>組態</strong>：應用程式的設定檔。</li>
<li><strong><code>IConfiguration</code></strong>：一個存在於記憶體中的字典，用來存取所有組態資料。</li>
<li><strong><code>IOptions</code> 家族</strong>：將 <code>IConfiguration</code> 的資料綁定到 C# 類別，並以不同生命週期管理。職責是「提供」C# 類別的物件。</li>
<li><strong><code>IConfigureOptions&lt;T&gt;</code></strong>：一個介面，讓你將複雜的設定邏輯獨立成一個可重複使用的類別。職責是「直接配置」這個 T 物件本身。</li>
</ul>

    </div>

    
    
    

    <footer class="post-footer"><!--google_adsense-->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6866375976707228" crossorigin="anonymous"></script>
      <div class="postfooter-google-adsense">
        <i class="fab fa-google"></i> AdSense
        <div class="google-adsense-instance">
            <ins class="adsbygoogle"
                style="display:block"
                data-ad-client="ca-pub-6866375976707228"
                data-ad-slot="8859920421"
                data-ad-format="auto"
                data-full-width-responsive="true"></ins>
            <script>
                 (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>        
      </div>
<!--/google_adsense-->
          <div class="post-tags">
              <a href="/tags/Advanced-Code/" rel="tag"># Advanced Code</a>
              <a href="/tags/Csharp-C/" rel="tag"># Csharp(C#)</a>
              <a href="/tags/Net-Core/" rel="tag"># .Net Core</a>
              <a href="/tags/Real-world-coding/" rel="tag"># Real-world coding</a>
              <a href="/tags/Advanced-Csharp-C/" rel="tag"># Advanced Csharp(C#)</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/09/14/Csharp-C/real-world-Csharp-export-csv/" rel="prev" title="工作中的 C# 實作：輸出 CSV 檔案 (一)">
                  <i class="fa fa-angle-left"></i> 工作中的 C# 實作：輸出 CSV 檔案 (一)
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/09/21/Csharp-C/real-world-Csharp-export-csv-with-OutputFormatter/" rel="next" title="工作中的 C# 實作：輸出 CSV 檔案 (二) - 用 OutputFormatter">
                  工作中的 C# 實作：輸出 CSV 檔案 (二) - 用 OutputFormatter <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    
  <div class="comments" id="disqus_thread">
    <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
  </div>
  
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2019 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Jenifer</span>
  </div>
  <div class="powered-by">由 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & <span class="exturl" data-url="aHR0cHM6Ly90aGVtZS1uZXh0LmpzLm9yZy9taXN0Lw==">NexT.Mist</span> 強力驅動
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="回到頂端">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

  <span class="exturl github-corner" data-url="aHR0cHM6Ly9naXRodWIuY29tL2plbmlmZXJzMDAxZA==" title="在 GitHub 上關注我" aria-label="在 GitHub 上關注我"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></span>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  






  




<script class="next-config" data-name="disqus" type="application/json">{"enable":true,"shortname":"disqus-comments","count":false,"i18n":{"disqus":"disqus"}}</script>
<script src="/js/third-party/comments/disqus.js"></script>

</body>
</html>
